{% extends 'base.html' %}

{% block title %}Download Compressed PowerPoint - PPT Compressor{% endblock %}

{% block content %}
<div class="success">
    <h2>Compression Complete!</h2>
    <p>Your PowerPoint file has been successfully compressed and is ready for download.</p>
    
    <div style="margin: 30px 0;">
        <a href="{{ url_for('get_file', filename=filename) }}">
            <button class="download-btn">Download Compressed File</button>
        </a>
    </div>
    
    <div style="margin: 20px 0;">
        <a href="{{ url_for('clean_and_redirect') }}">
            <button class="secondary-btn">Remove Files & Return to Homepage</button>
        </a>
    </div>
    
    <p>
        <a href="{{ url_for('index') }}">Compress another file</a>
    </p>
    
    <!-- Log Display Area -->
    <div class="log-container" id="log-container" style="margin-top: 30px;">
        <h3>Processing Logs</h3>
        <button id="toggle-logs-btn" onclick="toggleLogs()">Show Logs</button>
        <pre id="log-content" class="log-content" style="display: none;"></pre>
    </div>
</div>

<script>
    function toggleLogs() {
        const logContent = document.getElementById('log-content');
        const toggleBtn = document.getElementById('toggle-logs-btn');
        
        if (logContent.style.display === 'none') {
            logContent.style.display = 'block';
            toggleBtn.textContent = 'Hide Logs';
            fetchLogs(); // Fetch logs when showing
        } else {
            logContent.style.display = 'none';
            toggleBtn.textContent = 'Show Logs';
        }
    }
    
    function fetchLogs() {
        fetch('/logs')
            .then(response => response.json())
            .then(data => {
                document.getElementById('log-content').textContent = data.logs.join('\n');
            })
            .catch(error => console.error('Error fetching logs:', error));
    }
</script>
{% endblock %}